<section>
    <h1>Vue d'ensemble</h1>

    <div class="stats">
        <div class="card stat-card" *ngFor="let stat of stats()">
            <div class="stat-icon">
                {{ stat.icon }}
            </div>
            <div class="stat-info">
                <h3>{{ stat.value }}</h3>
                <p>{{ stat.title }}</p>
            </div>
        </div>
    </div>

    <div class="content-grid">
        <div class="card activity-card">
            <div class="card-header">
                <h3>ActivitÃ© RÃ©cente</h3>
                <button class="btn btn-outline btn-sm" routerLink="/taches" title="Voir toutes les tÃ¢ches">Voir
                    tout</button>
            </div>
            <div class="activity-list">
                <div class="activity-item" *ngFor="let activity of recentActivities()">
                    <div class="activity-icon">
                        <span *ngIf="activity.type === 'Candidature'">ðŸ“¤</span>
                        <span *ngIf="activity.type === 'Entretien'">ðŸ“…</span>
                        <span *ngIf="activity.type === 'TÃ¢che'">âœ…</span>
                    </div>
                    <div class="activity-details">
                        <h4>{{ activity.company || activity.title }}</h4>
                        <p>{{ activity.type }} â€¢ {{ activity.date }}</p>
                    </div>
                    <div class="activity-status badge">{{ activity.status }}</div>
                </div>
                <div *ngIf="recentActivities().length === 0" class="empty-state">
                    <div class="empty-icon"><i class="fa-solid fa-tasks"></i></div>
                    <h3>Aucune activitÃ© rÃ©cente</h3>
                    <p>Ajoutez une offre d'emploi ou une tÃ¢che.</p>
                </div>
            </div>
        </div>

        <div class="card chart-card">
            <div class="card-header">
                <h3>Ã‰volution des statuts</h3>
            </div>
            <div class="chart-container">
                <svg [attr.viewBox]="'0 0 ' + chartLayout().width + ' ' + chartLayout().fullHeight" class="chart-svg">
                    <!-- Grid Lines (Optional) -->
                    <line x1="0" y1="50" [attr.x2]="chartLayout().width" y2="50" stroke="#f0f0f0" stroke-width="1" />
                    <line x1="0" y1="100" [attr.x2]="chartLayout().width" y2="100" stroke="#f0f0f0" stroke-width="1" />
                    <line x1="0" y1="150" [attr.x2]="chartLayout().width" y2="150" stroke="#f0f0f0" stroke-width="1" />

                    <!-- Bars -->
                    <g *ngFor="let item of chartData(); let i = index">
                        <rect [attr.x]="i * chartLayout().step + (chartLayout().step - chartLayout().barWidth) / 2"
                            [attr.y]="chartLayout().height - (item.value / maxChartValue) * chartLayout().height"
                            [attr.width]="chartLayout().barWidth"
                            [attr.height]="(item.value / maxChartValue) * chartLayout().height" rx="4"
                            class="chart-bar" />
                        <text [attr.x]="i * chartLayout().step + chartLayout().step / 2"
                            [attr.y]="chartLayout().fullHeight - 15" text-anchor="middle" class="chart-label">{{
                            item.label }}</text>
                        <!-- Value on top of bar -->
                        <text [attr.x]="i * chartLayout().step + chartLayout().step / 2"
                            [attr.y]="chartLayout().height - (item.value / maxChartValue) * chartLayout().height - 5"
                            text-anchor="middle" class="chart-value">{{ item.value }}</text>
                    </g>

                    <!-- Line (Evolution) -->
                    <polyline [attr.points]="polylinePoints" fill="none" class="chart-line" stroke-width="3"
                        stroke-linecap="round" stroke-linejoin="round" />

                    <!-- Line Points -->
                    <g *ngFor="let item of chartData(); let i = index">
                        <circle [attr.cx]="i * chartLayout().step + chartLayout().step / 2"
                            [attr.cy]="chartLayout().height - (item.adjustment / maxChartValue) * chartLayout().height"
                            r="4" class="chart-point" />
                    </g>
                </svg>
                <div class="chart-legend">
                    <div class="legend-item">
                        <span class="legend-color bar-color"></span>
                        <span>Ce mois-ci</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color line-color"></span>
                        <span>Mois dernier</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>