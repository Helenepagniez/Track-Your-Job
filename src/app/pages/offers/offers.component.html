<div class="offers-container">
    <div class="page-header">
        <h2>Mes Offres</h2>
        <button class="btn btn-primary" (click)="openAddModal()">
            <span>+</span> Ajouter une offre
        </button>
    </div>

    <div class="filters-bar glass">
        <div class="search-box">
            <i class="icon">üîç</i>
            <input type="text" placeholder="Rechercher une offre..." class="search-input" [ngModel]="searchTerm()"
                (ngModelChange)="searchTerm.set($event)">
        </div>
        <div class="filter-options">
            <select class="form-select" [ngModel]="statusFilter()" (ngModelChange)="statusFilter.set($event)">
                <option value="">Tous les statuts</option>
                <option value="To Apply">√Ä postuler</option>
                <option value="Applied">En attente</option>
                <option value="Interview">Entretien</option>
                <option value="Offer">Offre re√ßue</option>
                <option value="Rejected">Refus√©</option>
            </select>
        </div>
    </div>

    <div class="offers-grid">
        <div class="card offer-card" *ngFor="let offer of filteredOffers()">
            <div class="offer-header">
                <div class="company-logo">{{ offer.company.charAt(0) }}</div>
                <div class="offer-main-info">
                    <h3>{{ offer.title }}</h3>
                    <p class="company-name">{{ offer.company }}</p>
                </div>
                <div class="offer-actions">
                    <button class="btn-icon">‚ãÆ</button>
                </div>
            </div>

            <div class="offer-details">
                <div class="detail-item">
                    <i class="icon">üìç</i> {{ offer.location }}
                </div>
                <div class="detail-item" *ngIf="offer.salary">
                    <i class="icon">üí∞</i> {{ offer.salary }}
                </div>
                <div class="detail-item">
                    <i class="icon">üìÖ</i> {{ offer.dateAdded | date:'dd MMM yyyy' }}
                </div>
            </div>

            <div class="offer-footer">
                <span class="status-badge" [style.background-color]="statusColors[offer.status] + '20'"
                    [style.color]="statusColors[offer.status]">
                    {{ getStatusLabel(offer.status) }}
                </span>
                <button class="btn btn-outline btn-sm" (click)="openDetailModal(offer)">Voir d√©tails</button>
            </div>
        </div>
    </div>
</div>

<!-- Add Offer Modal -->
<div class="modal-overlay" *ngIf="showAddModal()" (click)="closeAddModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h3>Ajouter une offre</h3>
            <button class="close-btn" (click)="closeAddModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label class="form-label">Titre du poste</label>
                <input type="text" class="form-control" [(ngModel)]="newOffer.title"
                    placeholder="Ex: D√©veloppeur Angular">
            </div>
            <div class="form-group">
                <label class="form-label">Entreprise</label>
                <input type="text" class="form-control" [(ngModel)]="newOffer.company" placeholder="Ex: Google">
            </div>
            <div class="form-group">
                <label class="form-label">Lieu</label>
                <input type="text" class="form-control" [(ngModel)]="newOffer.location"
                    placeholder="Ex: Paris / Remote">
            </div>
            <div class="form-group">
                <label class="form-label">Salaire (optionnel)</label>
                <input type="text" class="form-control" [(ngModel)]="newOffer.salary" placeholder="Ex: 45k - 55k">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-control" [(ngModel)]="newOffer.description"
                    placeholder="D√©tails du poste..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Statut</label>
                <select class="form-control" [(ngModel)]="newOffer.status">
                    <option value="To Apply">√Ä postuler</option>
                    <option value="Applied">En attente</option>
                    <option value="Interview">Entretien</option>
                    <option value="Offer">Offre re√ßue</option>
                    <option value="Rejected">Refus√©</option>
                </select>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-outline" (click)="closeAddModal()">Annuler</button>
            <button class="btn btn-primary" (click)="submitOffer()">Ajouter</button>
        </div>
    </div>
</div>

<!-- View Detail Modal -->
<div class="modal-overlay" *ngIf="showDetailModal()" (click)="closeDetailModal()">
    <div class="modal-content" (click)="$event.stopPropagation()" *ngIf="selectedOffer() as offer">
        <div class="modal-header">
            <h3>{{ offer.title }}</h3>
            <button class="close-btn" (click)="closeDetailModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="detail-item">
                <strong>Entreprise:</strong> {{ offer.company }}
            </div>
            <div class="detail-item">
                <strong>Lieu:</strong> {{ offer.location }}
            </div>
            <div class="detail-item">
                <strong>Statut:</strong>
                <span class="status-badge" [style.background-color]="statusColors[offer.status] + '20'"
                    [style.color]="statusColors[offer.status]">
                    {{ getStatusLabel(offer.status) }}
                </span>
            </div>
            <div class="detail-item" *ngIf="offer.salary">
                <strong>Salaire:</strong> {{ offer.salary }}
            </div>
            <div class="detail-item" *ngIf="offer.description">
                <strong>Description:</strong>
                <p>{{ offer.description }}</p>
            </div>
            <div class="detail-item">
                <strong>Ajout√© le:</strong> {{ offer.dateAdded | date:'fullDate' }}
            </div>
            <div class="detail-item" *ngIf="offer.companyInfo">
                <strong>Infos Entreprise:</strong>
                <ul style="list-style: none; padding-left: 0;">
                    <li *ngIf="offer.companyInfo.employees">Employ√©s: {{ offer.companyInfo.employees }}</li>
                    <li *ngIf="offer.companyInfo.founded">Fond√©e en: {{ offer.companyInfo.founded }}</li>
                </ul>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" (click)="closeDetailModal()">Fermer</button>
        </div>
    </div>
</div>